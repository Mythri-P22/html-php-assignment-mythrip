<?php
// Step 1: Connect to database
$conn = new mysqli("localhost", "root", "", "student_db");

// Check connection
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

// Step 2: Handle form submission to add a new student
if(isset($_POST['submit'])){
    $name = $_POST['name'];
    $grade = $_POST['grade'];

    $sql = "INSERT INTO students (name, grade) VALUES ('$name', '$grade')";
    if($conn->query($sql) === TRUE){
        echo "<p style='color:green;'>Student added successfully!</p>";
    } else {
        echo "<p style='color:red;'>Error: " . $conn->error . "</p>";
    }
}
?>

<h2>Add New Student</h2>
<form method="post">
    Name: <input type="text" name="name" maxlength="25" required><br><br>
    Grade: <input type="text" name="grade" maxlength="10" required><br><br>
    <input type="submit" name="submit" value="Add Student">
</form>

<h2>All Students</h2>
<?php
// Step 3: Fetch and display all students
$result = $conn->query("SELECT * FROM students");

if($result->num_rows > 0){
    echo "<table border='1' cellpadding='5'>";
    echo "<tr><th>ID</th><th>Name</th><th>Grade</th></tr>";
    while($row = $result->fetch_assoc()){
        echo "<tr>
                <td>".$row['id']."</td>
                <td>".$row['name']."</td>
                <td>".$row['grade']."</td>
              </tr>";
    }
    echo "</table>";
} else {
    echo "<p>No students found.</p>";
}

// Step 4: Close connection
$conn->close();
?>
